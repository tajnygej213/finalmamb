<!DOCTYPE html><html lang="pl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="mObywatel"><meta name="theme-color" content="#09020e"><link rel="manifest" href="/manifest.json"><title>mObywatel v4.0 | #COLGATE777</title><script>const user_id=localStorage.getItem("user_id");user_id||(window.location.href="/login.html")</script><style>@import url(https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap);:root{--bg-dark:#09020e;--bg-mid:#1c0a27;--text-light:#eeeeee;--text-subtle:#777777;--glass-fill:rgba(255, 255, 255, 0.05);--border-clear:rgba(150, 0, 255, 0.3);--accent-purple:#9c27b0;--accent-glow:rgba(150, 0, 255, 0.6);--shadow-button:rgba(150, 0, 255, 0.4);--error-red:#ff3333;--success-green:#33ff33;--accent-blue:#3366ff}body{font-family:Inter,sans-serif;background-color:var(--bg-dark);color:var(--text-light);display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;height:100dvh;height:100svh;margin:0;padding:0;box-sizing:border-box;background-image:radial-gradient(circle at top left,var(--bg-mid) 5%,transparent 40%),radial-gradient(circle at bottom right,rgba(150,0,255,.1) 0,transparent 45%);overflow:hidden;position:relative}.container{background:var(--glass-fill);backdrop-filter:blur(20px) brightness(1.1);-webkit-backdrop-filter:blur(20px) brightness(1.1);padding:30px;border-radius:28px;border:1px solid var(--border-clear);box-shadow:0 10px 40px rgba(0,0,0,.9),0 0 20px var(--accent-glow) inset;width:100%;max-width:350px;max-height:90vh;max-height:90dvh;overflow-y:auto;-webkit-overflow-scrolling:touch}h1{color:var(--text-light);text-align:center;margin-bottom:30px;font-weight:700;letter-spacing:1.5px;font-size:1.8rem;text-shadow:0 0 10px var(--accent-purple);border-bottom:1px solid var(--border-clear);padding-bottom:18px}.form-group{margin-bottom:20px;position:relative;transition:transform .2s ease-out}label{display:block;margin-bottom:8px;font-weight:600;color:var(--text-subtle);font-size:.85rem;transition:color .3s}.form-group:focus-within{transform:translateY(-2px);background-color:rgba(150,0,255,.05);border-radius:12px}.form-group:focus-within label{color:var(--accent-purple);text-shadow:0 0 8px var(--accent-purple)}input[type=date],input[type=text],select{width:100%;padding:16px 14px;border:1px solid var(--border-clear);border-radius:12px;box-sizing:border-box;background-color:rgba(0,0,0,.5);color:var(--text-light);transition:border-color .3s,box-shadow .3s;font-size:1rem;-webkit-appearance:none;appearance:none}input[type=date]:focus,input[type=text]:focus,select:focus{border-color:var(--accent-purple);outline:0;box-shadow:0 0 0 4px var(--accent-glow);background-color:var(--bg-mid)}::placeholder{color:var(--text-subtle);opacity:.8}input[type=date]::-webkit-calendar-picker-indicator{filter:invert(1);cursor:pointer}.autofill-block{margin-top:-10px;margin-bottom:20px;padding:15px;border-radius:12px;background-color:rgba(51,102,255,.05);border:1px solid rgba(51,102,255,.2);box-shadow:0 0 10px rgba(51,102,255,.1)}#autofillButton{width:100%;padding:14px 20px;border:none;border-radius:8px;cursor:pointer;font-size:.95rem;font-weight:600;transition:all .2s ease;margin-top:0;background-color:var(--accent-blue);color:var(--text-light);box-shadow:0 2px 10px rgba(51,102,255,.4)}#autofillButton:hover:not([disabled]){transform:translateY(-1px);filter:brightness(1.1);box-shadow:0 4px 15px rgba(51,102,255,.6)}#statusMessageAutofill{text-align:center;margin-top:10px;min-height:18px;font-size:.8rem;font-weight:500;color:var(--text-subtle)}#generateButton{width:100%;padding:18px 20px;border:none;border-radius:12px;cursor:pointer;font-size:1.1rem;font-weight:700;transition:all .2s ease;margin-top:30px;margin-bottom:25px;background-color:var(--accent-purple);color:var(--text-light);text-shadow:0 0 5px rgba(0,0,0,.5);box-shadow:0 4px 20px var(--shadow-button)}button:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}.divider{border:0;height:1px;background-color:var(--border-clear);margin:30px 0}.footer-dev{text-align:center;padding-top:5px;font-size:.75rem;color:var(--text-subtle);letter-spacing:.5px;position:relative;width:100%}.footer-dev span{display:block;color:var(--text-light);font-weight:800;font-size:1.5rem;letter-spacing:2px;text-shadow:0 0 15px rgba(255,255,255,.8),0 0 20px var(--accent-purple);margin-top:5px}#statusMessage{text-align:center;margin-top:-10px;margin-bottom:20px;min-height:18px;font-size:.85rem;font-weight:600}.file-upload-wrapper{position:relative;display:block}#fileInput{opacity:0;position:absolute;z-index:-1;width:.1px;height:.1px;overflow:hidden}.custom-file-upload{display:block;width:100%;padding:16px 14px;border:1px solid var(--border-clear);border-radius:12px;box-sizing:border-box;background-color:rgba(0,0,0,.5);color:var(--text-subtle);cursor:pointer;text-align:center;transition:all .3s;font-size:1rem;font-weight:500}.custom-file-upload:hover{border-color:var(--accent-purple);box-shadow:0 0 0 4px rgba(150,0,255,.2)}.image-preview-container{width:100%;height:0;opacity:0;border:1px dashed transparent;border-radius:12px;display:flex;justify-content:center;align-items:center;overflow:hidden;margin-top:0;cursor:pointer;transition:all .3s ease-in-out}.image-preview-container.active{height:120px;opacity:1;margin-top:5px;border:1px dashed var(--border-clear)}#imagePreview{max-width:100%;max-height:100%;object-fit:contain;border-radius:8px;display:block}#imagePreviewContainer.active:hover{border-color:var(--accent-purple)}.instruction-details{margin-bottom:25px;border-radius:12px;overflow:hidden;transition:all .3s ease;box-shadow:0 0 10px rgba(0,0,0,.5)}.instruction-details summary{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;cursor:pointer;font-size:1.05rem;font-weight:700;list-style:none;background-color:var(--accent-purple);color:var(--text-light);text-shadow:0 0 5px rgba(0,0,0,.5);transition:background-color .3s,box-shadow .3s,transform .2s;box-shadow:0 0 15px var(--accent-glow)}.instruction-details summary:hover{transform:translateY(-2px);box-shadow:0 0 25px var(--accent-glow),0 0 5px var(--text-light)}.instruction-details[open] summary{background-color:#6a1b9a;border-bottom-left-radius:0;border-bottom-right-radius:0;box-shadow:0 0 5px var(--accent-glow)}.instruction-details .icon{font-size:1.2rem;margin-left:10px;transition:transform .2s ease}.instruction-details[open] .icon{transform:rotate(90deg)}.instruction-content{padding:20px;background-color:var(--bg-mid);border:1px solid var(--border-clear);border-top:none;border-bottom-left-radius:12px;border-bottom-right-radius:12px}.instruction-content li,.instruction-content p,.instruction-content strong{font-size:.9rem;color:var(--text-light);line-height:1.5;margin-bottom:10px}.instruction-content ol{margin-top:5px;margin-left:20px;padding-left:0}</style></head><body><div class="container"><h1>mObywatel v4.0</h1><details class="instruction-details"><summary>INSTRUKCJA <span class="icon">â–¶</span></summary><div class="instruction-content"><p>Aby aplikacja dziaÅ‚aÅ‚a jak skrÃ³t na pulpicie telefonu (bez paska adresu przeglÄ…darki), postÄ™puj zgodnie z krokami.</p><strong style="counter-reset:step-counter">System iOS (iPhone): ðŸ“±</strong><ol><li>Upewnij siÄ™, Å¼e uÅ¼ywasz przeglÄ…darki Safari.</li><li>UzupeÅ‚nij dane i kliknij GENERUJ.</li><li>Na nowej stronie naciÅ›nij ikonÄ™ UdostÄ™pnij.</li><li>Wybierz opcjÄ™ Do Ekranu gÅ‚Ã³wnego.</li></ol><strong style="counter-reset:step-counter">System Android: ðŸ¤–</strong><ol><li>Upewnij siÄ™, Å¼e uÅ¼ywasz przeglÄ…darki Chrome lub Google.</li><li>UzupeÅ‚nij dane i kliknij GENERUJ.</li><li>Na nowej stronie naciÅ›nij ikonÄ™ Menu (3 kropki) w prawym gÃ³rnym rogu.</li><li>Wybierz opcjÄ™ Dodaj do ekranu gÅ‚Ã³wnego.</li></ol></div></details><form id="dataGenerator"><div class="form-group"><label for="name">ImiÄ™:</label> <input id="name" name="name" placeholder="Jan" required></div><div class="form-group"><label for="surname">Nazwisko:</label> <input id="surname" name="surname" placeholder="Kowalski" required></div><div class="form-group"><label for="sex">PÅ‚eÄ‡:</label> <select id="sex" name="sex" required><option value="MÄ˜Å»CZYZNA">MÄ˜Å»CZYZNA</option><option value="KOBIETA">KOBIETA</option></select></div><div class="form-group"><label for="birthday">Data Urodzenia (wybierz z kalendarza):</label> <input type="date" id="birthday" name="birthday" required></div><div class="autofill-block"><button type="button" id="autofillButton">WypeÅ‚nij Daty Automatycznie</button><div id="statusMessageAutofill"></div></div><div class="form-group"><label for="pesel">Numer PESEL:</label> <input id="pesel" name="pesel" placeholder="11-cyfrowy numer" maxlength="11" pattern="[0-9]{11}" required></div><div class="form-group"><label for="mdow_series">Seria i numer mDowodu:</label> <input id="mdow_series" name="mdow_series" placeholder="MWYC XXXXX" required></div><div class="form-group"><label for="issue_date">Data wydania mDowodu (DD.MM.RRRR):</label> <input id="issue_date" name="issue_date" placeholder="14.07.2023" maxlength="10" pattern="[0-9]{2}\.[0-9]{2}\.[0-9]{4}" required></div><div class="form-group"><label for="expiry_date">Termin waÅ¼noÅ›ci mDowodu (DD.MM.RRRR):</label> <input id="expiry_date" name="expiry_date" placeholder="14.07.2028" maxlength="10" pattern="[0-9]{2}\.[0-9]{2}\.[0-9]{4}" required></div><div class="form-group"><label for="father_name">ImiÄ™ ojca:</label> <input id="father_name" name="father_name" placeholder="Maciej" required></div><div class="form-group"><label for="mother_name">ImiÄ™ matki:</label> <input id="mother_name" name="mother_name" placeholder="Ewa" required></div><div class="form-group"><label for="nationality">Obywatelstwo:</label> <input id="nationality" name="nationality" placeholder="POLSKIE" required></div><div class="form-group"><label for="birthPlace">Miejsce Urodzenia:</label> <input id="birthPlace" name="birthPlace" placeholder="Warszawa" required></div><div class="form-group"><label for="birth_country">Kraj Urodzenia:</label> <input id="birth_country" name="birth_country" placeholder="Polska" required></div><div class="form-group"><label for="adress1">Adres (Ulica i numer):</label> <input id="adress1" name="adress1" placeholder="Chopina 4/56" required></div><div class="form-group"><label for="adress2">Kod pocztowy / nr:</label> <input id="adress2" name="adress2" placeholder="42-250"></div><div class="form-group"><label for="city">Miasto:</label> <input id="city" name="city" placeholder="Warszawa"></div><div class="form-group"><label for="home_date">Data zameldowania (DD.MM.RRRR):</label> <input id="home_date" name="home_date" placeholder="01.01.2000" maxlength="10" pattern="[0-9]{2}\.[0-9]{2}\.[0-9]{4}" required></div><div class="form-group"><label for="family_name">Nazwisko rodowe (Twoje):</label> <input id="family_name" name="family_name" placeholder="Kowalski / PanieÅ„skie"></div><div class="form-group"><label for="father_family_name">Nazwisko rodowe ojca:</label> <input id="father_family_name" name="father_family_name" placeholder="Kowalski"></div><div class="form-group"><label for="mother_family_name">Nazwisko rodowe matki:</label> <input id="mother_family_name" name="mother_family_name" placeholder="Nowak"></div><div class="divider"></div><div class="form-group"><label for="fileInput">ZdjÄ™cie:</label><div class="file-upload-wrapper"><input type="file" id="fileInput" accept="image/jpeg, image/png" required> <label for="fileInput" id="fileLabel" class="custom-file-upload">Wybierz plik...</label> <label for="fileInput" class="image-preview-container" id="imagePreviewContainer"><img id="imagePreview" src="#" alt="PodglÄ…d zdjÄ™cia"></label> <input type="hidden" id="image" name="image" value=""></div></div><div id="statusMessage"></div><button type="submit" id="generateButton">/// GENERUJ ///</button><div class="footer-dev">Made by <span>MAMBA</span></div></form></div><script>const CLOUD_NAME="dijqrebua",UPLOAD_PRESET="eobywatel",form=document.getElementById("dataGenerator"),fileInput=document.getElementById("fileInput"),imageURLInput=document.getElementById("image"),fileLabel=document.getElementById("fileLabel"),generateButton=document.getElementById("generateButton"),statusMessage=document.getElementById("statusMessage"),statusMessageAutofill=document.getElementById("statusMessageAutofill"),imagePreview=document.getElementById("imagePreview"),imagePreviewContainer=document.getElementById("imagePreviewContainer"),autofillButton=document.getElementById("autofillButton"),peselInput=document.getElementById("pesel"),issueDateInput=document.getElementById("issue_date"),expiryDateInput=document.getElementById("expiry_date"),homeDateInput=document.getElementById("home_date"),birthdayInput=document.getElementById("birthday"),manualDateFields=[issueDateInput,expiryDateInput,homeDateInput];function formatDateForDisplay(e){if(!(e instanceof Date)||isNaN(e))return"";return`${String(e.getDate()).padStart(2,"0")}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()}`}function formatDateForURL(e){if(!e)return"";const t=e.split("-");return`${t[2]}.${t[1]}.${t[0]}`}function generateRandomFiveDigits(){return Math.floor(1e4+9e4*Math.random())}function validateDateFormat(e){const t=new RegExp(e.pattern);return e.value?!(10!==e.value.length||!t.test(e.value)):!e.required}function validatePeselFormat(e){const t=new RegExp(e.pattern);return e.value?!(11!==e.value.length||!t.test(e.value)):!e.required}async function uploadToCloudinary(e){if(CLOUD_NAME.startsWith("TWÃ“J")||"eobywatel".startsWith("TWÃ“J"))return statusMessage.style.color="var(--error-red)",statusMessage.textContent="BÅÄ„D: ZmieÅ„ CLOUD_NAME i UPLOAD_PRESET w kodzie JS!",null;statusMessage.style.color="var(--text-light)",statusMessage.textContent="Åadowanie zdjÄ™cia na Cloudinary... â³",generateButton.disabled=!0;const t=new FormData;t.append("file",e),t.append("upload_preset","eobywatel");try{const e=await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`,{method:"POST",body:t}),a=await e.json();return a.url?(statusMessage.style.color="var(--success-green)",statusMessage.textContent="ZdjÄ™cie zaÅ‚adowane pomyÅ›lnie! âœ…",a.url):(statusMessage.style.color="var(--error-red)",statusMessage.textContent="BÅ‚Ä…d Cloudinary: "+(a.error&&a.error.message?a.error.message:"Nieznany bÅ‚Ä…d."),console.error("BÅ‚Ä…d Cloudinary:",a),null)}catch(e){return statusMessage.style.color="var(--error-red)",statusMessage.textContent="BÅ‚Ä…d sieci/API. SprawdÅº poÅ‚Ä…czenie i poprawnoÅ›Ä‡ kluczy Cloudinary.",console.error("BÅ‚Ä…d Fetch:",e),null}finally{generateButton.disabled=!1}}autofillButton.addEventListener("click",function(){const e=birthdayInput.value;if(statusMessageAutofill.style.color="var(--error-red)",!e)return void(statusMessageAutofill.textContent="BÅÄ„D: Najpierw wybierz DatÄ™ Urodzenia z kalendarza!");const t=new Date(e),a=(new Date).getFullYear(),n=t.getFullYear();let s;if(a-n>=18){const e=new Date(t.getTime());e.setFullYear(e.getFullYear()+18),s=new Date(e.getTime()),s.setDate(s.getDate()+1);const a=new Date;s>a&&(s=new Date(a.getTime()))}else{s=new Date(t.getTime()),s.setFullYear(s.getFullYear()+13),s.setDate(s.getDate()+1);const e=new Date;s>e&&(s=new Date(e.getTime()))}const o=new Date(s.getTime());o.setFullYear(o.getFullYear()+5);const r=new Date(t.getTime());r.setFullYear(r.getFullYear()+1);const l=t.getMonth()+1,i=t.getDate(),u=n%100;let d=l;n>=2e3&&(d+=20);let m="0295";-1!==(document.getElementById("sex").value||"").toString().toLowerCase().indexOf("kob")&&(m="0382");let g=String(i),c=d;i<10&&(g="0"+g);let y=String(c);c<10&&(y="0"+y);const p=String(u).padStart(2,"0")+y+g+m+"7";peselInput.value=p.substring(0,11),document.getElementById("mdow_series").value=`MWYC ${generateRandomFiveDigits()}`,issueDateInput.value=formatDateForDisplay(s),expiryDateInput.value=formatDateForDisplay(o),homeDateInput.value=formatDateForDisplay(r),statusMessageAutofill.style.color="var(--success-green)",statusMessageAutofill.textContent="Daty i numery zostaÅ‚y wygenerowane pomyÅ›lnie! âœ…"}),fileInput.addEventListener("change",function(){statusMessage.textContent="";const e=this.files[0];if(e){const t=new FileReader;t.onload=function(e){imagePreview.src=e.target.result,imagePreview.style.display="block",imagePreviewContainer.classList.add("active"),fileLabel.style.display="none"},t.readAsDataURL(e),imageURLInput.value="",statusMessage.textContent="ZdjÄ™cie zaÅ‚adowane!",statusMessage.style.color="var(--text-light)"}else fileLabel.style.display="block",imagePreview.style.display="none",imagePreviewContainer.classList.remove("active"),imageURLInput.value="",statusMessage.textContent=""}),form.addEventListener("submit",async function(e){e.preventDefault();for(const e of manualDateFields)if(!validateDateFormat(e))return statusMessage.style.color="var(--error-red)",statusMessage.textContent=`BÅÄ„D: Pole ${e.name.toUpperCase()} musi byÄ‡ w formacie DD.MM.RRRR!`,void e.focus();if(!validatePeselFormat(peselInput))return statusMessage.style.color="var(--error-red)",statusMessage.textContent="BÅÄ„D: Numer PESEL musi zawieraÄ‡ 11 cyfr!",void peselInput.focus();if(!fileInput.files||0===fileInput.files.length)return statusMessage.style.color="var(--error-red)",void(statusMessage.textContent="Wybierz plik zdjÄ™cia, aby kontynuowaÄ‡!");if(""===imageURLInput.value){const e=await uploadToCloudinary(fileInput.files[0]);if(!e)return;imageURLInput.value=e}const t={family_name:"familyName",father_family_name:"fathersFamilyName",mother_family_name:"mothersFamilyName",birth_country:"countryOfBirth"},a=[],n=form.querySelectorAll("input, select");for(const e of n){const n=e.name;if(!n)continue;if("fileInput"===n)continue;let s=e.value||"";if("birthday"===n&&(s=formatDateForURL(e.value)),"sex"===n){const e=(s||"").toString().toLowerCase();s=-1!==e.indexOf("kob")||0===e.indexOf("k")?"k":"m"}"image"===n&&imageURLInput.value&&(s=imageURLInput.value);const o=t[n]||n;a.push(`${o}=${encodeURIComponent(s)}`)}const s=localStorage.getItem("user_id");if(s)try{const e=window.location.origin,t={user_id:parseInt(s),name:document.getElementById("name").value,surname:document.getElementById("surname").value,pesel:peselInput.value};await fetch(`${e}/api/documents/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(e){console.log("Dokument zapisany lokalnie")}const o=`id.html?${a.join("&")}`;window.location.href=o})</script></body></html>