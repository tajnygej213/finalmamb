<!DOCTYPE html><html lang="pl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Admin Panel - mObywatel</title><style>:root{--bg-dark:#09020e;--text-light:#eeeeee;--accent-purple:#9c27b0}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Inter,sans-serif;background-color:var(--bg-dark);color:var(--text-light);padding:20px}.container{max-width:1200px;margin:0 auto}h1{text-align:center;margin-bottom:30px;color:var(--accent-purple)}.tabs{display:flex;gap:10px;margin-bottom:30px;border-bottom:2px solid rgba(150,0,255,.3)}button.tab{padding:10px 20px;background:0 0;border:none;color:var(--text-light);cursor:pointer;font-size:1rem;border-bottom:3px solid transparent;transition:all .3s}button.tab.active{border-bottom-color:var(--accent-purple);color:var(--accent-purple)}.tab-content{display:none}.tab-content.active{display:block}table{width:100%;border-collapse:collapse;background:rgba(255,255,255,.05);border-radius:8px;overflow:hidden}td,th{padding:15px;text-align:left;border-bottom:1px solid rgba(150,0,255,.2)}th{background:rgba(150,0,255,.1);font-weight:700}button.action{padding:8px 15px;background:var(--accent-purple);border:none;border-radius:5px;color:#fff;cursor:pointer;font-weight:600}button.action:hover{opacity:.8}button.action.revoke{background:#f33}.logout{position:fixed;top:20px;right:20px}.logout button{padding:10px 20px;background:#f33;border:none;border-radius:5px;color:#fff;cursor:pointer;font-weight:600}</style></head><body><div class="logout"><button onclick="logout()">Wyloguj</button></div><div class="container"><h1>üìä Admin Panel</h1><div class="tabs"><button class="tab active" onclick='switchTab("users")'>U≈ºytkownicy</button> <button class="tab" onclick='switchTab("create")'>Stw√≥rz konto</button> <button class="tab" onclick='switchTab("documents")'>Dokumenty</button></div><div id="users" class="tab-content active"><h2>ZarzƒÖdzanie u≈ºytkownikami</h2><table id="usersTable"><thead><tr><th>ID</th><th>Nazwa</th><th>Dostƒôp</th><th>Data rejestracji</th><th>Akcja</th></tr></thead><tbody></tbody></table></div><div id="create" class="tab-content"><h2>Stw√≥rz nowe konto</h2><form id="createUserForm" style="max-width:400px"><div class="form-group" style="margin-bottom:15px"><label for="newUsername" style="display:block;margin-bottom:5px;color:#777">Nazwa u≈ºytkownika:</label> <input id="newUsername" placeholder="np. john_doe" required style="width:100%;padding:10px;border:1px solid rgba(150,0,255,.3);border-radius:5px;background:rgba(0,0,0,.3);color:#eee"></div><div class="form-group" style="margin-bottom:15px"><label for="newPassword" style="display:block;margin-bottom:5px;color:#777">Has≈Ço:</label> <input id="newPassword" placeholder="np. SecurePass123" required style="width:100%;padding:10px;border:1px solid rgba(150,0,255,.3);border-radius:5px;background:rgba(0,0,0,.3);color:#eee"></div><button type="submit" style="width:100%;padding:10px;background:#9c27b0;border:none;border-radius:5px;color:#fff;font-weight:600;cursor:pointer">Stw√≥rz konto</button><div id="createMessage" style="margin-top:15px;text-align:center"></div></form></div><div id="documents" class="tab-content"><h2>Wygenerowane dokumenty</h2><table id="documentsTable"><thead><tr><th>ID</th><th>U≈ºytkownik</th><th>Imiƒô</th><th>Nazwisko</th><th>PESEL</th><th>Data</th></tr></thead><tbody></tbody></table></div></div><script>const API_URL=window.location.origin,admin_user_id=localStorage.getItem("admin_user_id"),admin_username=localStorage.getItem("admin_username");function switchTab(e){document.querySelectorAll(".tab-content").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".tab").forEach(e=>e.classList.remove("active")),document.getElementById(e).classList.add("active"),event.target.classList.add("active"),"users"===e?loadUsers():"documents"===e?loadDocuments():"create"===e&&setupCreateForm()}function setupCreateForm(){const e=document.getElementById("createUserForm"),t=document.getElementById("createMessage");e.onsubmit=async a=>{a.preventDefault();const n=document.getElementById("newUsername").value,o=document.getElementById("newPassword").value;try{const a=await fetch(`${API_URL}/api/auth/create-user`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:o})}),s=await a.json();a.ok?(t.style.color="#33ff33",t.textContent=`‚úÖ Konto "${n}" stworzone pomy≈õlnie!`,e.reset()):(t.style.color="#ff3333",t.textContent=`‚ùå B≈ÇƒÖd: ${s.error}`)}catch(e){t.style.color="#ff3333",t.textContent=`‚ùå B≈ÇƒÖd: ${e.message}`}}}async function loadUsers(){try{const e=await fetch(`${API_URL}/api/admin/users`);if(!e.ok)throw new Error("Failed to load users");const t=await e.json();document.querySelector("#usersTable tbody").innerHTML=t.map(e=>`\n                    <tr>\n                        <td>${e.id}</td>\n                        <td>${e.username}</td>\n                        <td>${e.has_access?"‚úÖ Tak":"‚ùå Nie"}</td>\n                        <td>${new Date(e.created_at).toLocaleDateString("pl-PL")}</td>\n                        <td>\n                            ${e.has_access?`<button class="action revoke" onclick="updateAccess(${e.id}, false)">Zablokuj dostƒôp</button>`:`<button class="action" onclick="updateAccess(${e.id}, true)">Daj dostƒôp</button>`}\n                        </td>\n                    </tr>\n                `).join("")}catch(e){alert("B≈ÇƒÖd: "+e.message)}}async function loadDocuments(){try{const e=await fetch(`${API_URL}/api/admin/documents`);if(!e.ok)throw new Error("Failed to load documents");const t=await e.json();document.querySelector("#documentsTable tbody").innerHTML=t.map(e=>`\n                    <tr>\n                        <td>${e.id}</td>\n                        <td>${e.username}</td>\n                        <td>${e.name}</td>\n                        <td>${e.surname}</td>\n                        <td>${e.pesel}</td>\n                        <td>${new Date(e.created_at).toLocaleDateString("pl-PL")}</td>\n                    </tr>\n                `).join("")}catch(e){alert("B≈ÇƒÖd: "+e.message)}}async function updateAccess(e,t){try{(await fetch(`${API_URL}/api/admin/users/${e}/access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_access:t})})).ok&&loadUsers()}catch(e){alert("B≈ÇƒÖd: "+e.message)}}function logout(){localStorage.removeItem("admin_user_id"),localStorage.removeItem("admin_username"),window.location.href="/admin-login.html"}admin_user_id||(window.location.href="/admin-login.html"),loadUsers()</script></body></html>